CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);

BEGIN TRANSACTION;

CREATE TABLE "TB_CATEGORIES" (
    "ID_CATEGORY" TEXT NOT NULL CONSTRAINT "PK_TB_CATEGORIES" PRIMARY KEY,
    "DESCRIPTION" TEXT NOT NULL
);

CREATE TABLE "TB_ORDERS" (
    "ID_ORDER" TEXT NOT NULL CONSTRAINT "PK_TB_ORDERS" PRIMARY KEY,
    "DATE" TEXT NOT NULL,
    "STATUS" INTEGER NOT NULL
);

CREATE TABLE "TB_SELLERS" (
    "ID_SELLER" TEXT NOT NULL CONSTRAINT "PK_TB_SELLERS" PRIMARY KEY,
    "NAME" TEXT NOT NULL,
    "DS_EMAIL" TEXT NOT NULL
);

CREATE TABLE "TB_PRODUCTS" (
    "ID_PRODUCT" TEXT NOT NULL CONSTRAINT "PK_TB_PRODUCTS" PRIMARY KEY,
    "DESCRIPTION" TEXT NOT NULL,
    "PRICE" TEXT NOT NULL,
    "CategoryId" TEXT NOT NULL,
    CONSTRAINT "FK_TB_PRODUCTS_TB_CATEGORIES_CategoryId" FOREIGN KEY ("CategoryId") REFERENCES "TB_CATEGORIES" ("ID_CATEGORY") ON DELETE CASCADE
);

CREATE TABLE "TB_PHONES" (
    "ID_PHONE" TEXT NOT NULL CONSTRAINT "PK_TB_PHONES" PRIMARY KEY,
    "DDD" TEXT NOT NULL,
    "NUMBER" TEXT NOT NULL,
    "TYPE" TEXT NOT NULL,
    "ID_SELLER" TEXT NOT NULL,
    CONSTRAINT "FK_TB_PHONES_TB_SELLERS_ID_SELLER" FOREIGN KEY ("ID_SELLER") REFERENCES "TB_SELLERS" ("ID_SELLER") ON DELETE CASCADE
);

CREATE TABLE "TB_SALES" (
    "ID_SALE" TEXT NOT NULL CONSTRAINT "PK_TB_SALES" PRIMARY KEY,
    "MOMENT" TEXT NOT NULL,
    "STATUS" INTEGER NOT NULL,
    "ID_SELLER" TEXT NOT NULL,
    "ID_ORDER" TEXT NOT NULL,
    CONSTRAINT "FK_TB_SALES_TB_ORDERS_ID_ORDER" FOREIGN KEY ("ID_ORDER") REFERENCES "TB_ORDERS" ("ID_ORDER") ON DELETE CASCADE,
    CONSTRAINT "FK_TB_SALES_TB_SELLERS_ID_SELLER" FOREIGN KEY ("ID_SELLER") REFERENCES "TB_SELLERS" ("ID_SELLER") ON DELETE CASCADE
);

CREATE TABLE "TB_ORDER_ITEMS" (
    "ID_ORDER_ITEM" TEXT NOT NULL CONSTRAINT "PK_TB_ORDER_ITEMS" PRIMARY KEY,
    "QUANTITY" INTEGER NOT NULL,
    "ID_PRODUCT" TEXT NOT NULL,
    "ID_ORDER" TEXT NOT NULL,
    CONSTRAINT "FK_TB_ORDER_ITEMS_TB_ORDERS_ID_ORDER" FOREIGN KEY ("ID_ORDER") REFERENCES "TB_ORDERS" ("ID_ORDER") ON DELETE CASCADE,
    CONSTRAINT "FK_TB_ORDER_ITEMS_TB_PRODUCTS_ID_PRODUCT" FOREIGN KEY ("ID_PRODUCT") REFERENCES "TB_PRODUCTS" ("ID_PRODUCT") ON DELETE CASCADE
);

CREATE UNIQUE INDEX "IX_TB_CATEGORIES_DESCRIPTION" ON "TB_CATEGORIES" ("DESCRIPTION");

CREATE INDEX "IX_TB_ORDER_ITEMS_ID_ORDER" ON "TB_ORDER_ITEMS" ("ID_ORDER");

CREATE INDEX "IX_TB_ORDER_ITEMS_ID_PRODUCT" ON "TB_ORDER_ITEMS" ("ID_PRODUCT");

CREATE INDEX "IX_TB_PHONES_ID_SELLER" ON "TB_PHONES" ("ID_SELLER");

CREATE INDEX "IX_TB_PRODUCTS_CategoryId" ON "TB_PRODUCTS" ("CategoryId");

CREATE INDEX "IX_TB_SALES_ID_ORDER" ON "TB_SALES" ("ID_ORDER");

CREATE INDEX "IX_TB_SALES_ID_SELLER" ON "TB_SALES" ("ID_SELLER");

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20221129204901_Teste', '6.0.11');

COMMIT;

